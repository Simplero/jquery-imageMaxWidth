// Generated by CoffeeScript 1.4.0
(function() {

  $.fn.imageMaxWidth = function() {
    return this.each(function() {
      var $container, images, max_width;
      $container = $(this);
      images = $container.find('img:not(.image-max-width-done)').addClass('image-max-width-done').hide();
      max_width = $container.width();
      return images.each(function() {
        var $image, img;
        $image = $(this);
        img = new Image();
        img.onerror = function() {
          return $image.show();
        };
        img.onload = function() {
          if (this.width > max_width) {
            $image.css({
              width: max_width,
              height: Math.round(max_width / this.width * this.height)
            });
          }
          return $image.show();
        };
        return img.src = $image.attr('src');
      });
    });
  };

}).call(this);
